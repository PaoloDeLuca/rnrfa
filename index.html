<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>RNRFA by cvitolo</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>RNRFA</h1>
        <h2>UK National River Flow Archive data from R</h2>
        <a href="https://github.com/cvitolo/r_rnrfa" class="button"><small>View project on</small> GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a id="rnrfa-an-r-package-to-interact-with-the-uk-national-river-flow-archive" class="anchor" href="#rnrfa-an-r-package-to-interact-with-the-uk-national-river-flow-archive" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>RNRFA: an R package to interact with the UK National River Flow Archive</h1>

<p><a href="http://dx.doi.org/10.5281/zenodo.14722"><img src="https://zenodo.org/badge/doi/10.5281/zenodo.14722.svg" alt="DOI"></a></p>

<p>The UK National River Flow Archive serves daily streamflow data, spatial rainfall averages and information regarding elevation, geology, land cover and FEH related catchment descriptors.</p>

<p>There is currently an API under development that in future should provide access to the following services: metadata catalogue, catalogue filters based on a geographical bounding-box, catalogue filters based on metadata entries, gauged daily data for about 400 stations available in WaterML2 format, the OGC standard used to describe hydrological time series.  </p>

<p>The information returned by the first three services is in JSON format, while the last one is an XML variant.</p>

<p>The RNRFA package aims to achieve a simpler and more efficient access to data by providing wrapper functions to send HTTP requests and interpret XML/JSON responses. </p>

<p><strong>To cite this software:</strong><br>
Vitolo C. and Fry M., R interface for the National River Flow Archive (rnrfa, R package version 0.4.0), GitHub repository, <a href="https://github.com/cvitolo/r_rnrfa">https://github.com/cvitolo/r_rnrfa</a>, doi: <a href="http://dx.doi.org/10.5281/zenodo.14722">http://dx.doi.org/10.5281/zenodo.14722</a></p>

<h1>
<a id="dependencies" class="anchor" href="#dependencies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Dependencies</h1>

<p>The rnrfa package is dependent on a number of CRAN packages. Install them first:</p>

<div class="highlight highlight-source-r"><pre>install.packages(c(<span class="pl-s"><span class="pl-pds">"</span>XML2R<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>RCurl<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>zoo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rjson<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>rgdal<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>sp<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>stringr<span class="pl-pds">"</span></span>))</pre></div>

<p>This demo makes also use of external libraries. To install and load them run the following commands:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-smi">packs</span> <span class="pl-k">&lt;-</span> c(<span class="pl-s"><span class="pl-pds">"</span>devtools<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>parallel<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>ggplot2<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>DT<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>leaflet<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>dygraphs<span class="pl-pds">"</span></span>)
install.packages(<span class="pl-smi">packs</span>)
lapply(<span class="pl-smi">packs</span>, <span class="pl-smi">require</span>, <span class="pl-v">character.only</span> <span class="pl-k">=</span> <span class="pl-c1">TRUE</span>)</pre></div>

<h1>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation</h1>

<p>The stable version (preferred option) of rnrfa is available from CRAN using <code>install.packages("rnrfa")</code>, while the development version is available on github via devtools:</p>

<div class="highlight highlight-source-r"><pre>install_github(<span class="pl-s"><span class="pl-pds">"</span>cvitolo/r_rnrfa<span class="pl-pds">"</span></span>, <span class="pl-v">subdir</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>rnrfa<span class="pl-pds">"</span></span>)</pre></div>

<p>Now, load the rnrfa package:</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">rnrfa</span>)</pre></div>

<h1>
<a id="functions" class="anchor" href="#functions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Functions</h1>

<h2>
<a id="list-of-monitoring-stations" class="anchor" href="#list-of-monitoring-stations" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>List of monitoring stations</h2>

<p>The R function that deals with the NRFA catalogue to retrieve the full list of monitoring stations is called catalogue(). The function, used with no inputs, requests the full list of gauging stations with associated metadata. The output is a dataframe containing one record for each station and as many columns as the number of metadata entries available. </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Retrieve information for all the stations in the catalogue:</span>
<span class="pl-smi">allStations</span> <span class="pl-k">&lt;-</span> catalogue()</pre></div>

<p>Those entries are briefly described as follows:</p>

<ul>
<li>"id" = Station identification number</li>
<li>"name" = Name of the station</li>
<li>"location" = Area in which the station is located</li>
<li>"river" = River catchment</li>
<li>"stationDescription" = General station description, containing information on weirs, ratings, etc.</li>
<li>"catchmentDescription" = Information on topography, geology, land cover, etc.</li>
<li>"hydrometricArea" = UK hydrometric area identification number</li>
<li>"operator" = UK measuring authorities</li>
<li>"haName" = Hydrometric Area name</li>
<li>"gridReference" = OS Grid Reference number</li>
<li>"stationType" = Type of station (e.g. flume, weir, etc.)</li>
<li>"catchmentArea" = Catchment area in (Km^2)</li>
<li>"gdfStart" = Year in which recordings started</li>
<li>"gdfEnd" = Year in which recordings ended</li>
<li>"farText" = Information on the regime (e.g. natural, regulated, etc.)</li>
<li>"categories" = various tags (e.g. FEH_POOLING, FEH_QMED, HIFLOWS_INCLUDED)</li>
<li>"altitude" = Altitude measured in metres above Ordnance Datum or, in Northern Ireland, Malin Head.</li>
<li>"sensitivity" = Sensitivity index calculated as the percentage change in flow associated with a 10 mm increase in stage at the $Q_{95}$ flow.</li>
<li>"lat" = a numeric vector of latitude coordinates.</li>
<li>"lon" = a numeric vector of longitude coordinates.</li>
</ul>

<h2>
<a id="station-filtering" class="anchor" href="#station-filtering" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Station filtering</h2>

<p>The same function catalogue() can be used to filter stations based on a bounding box or any of the metadata entries. </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Define a bounding box:</span>
<span class="pl-smi">bbox</span> <span class="pl-k">&lt;-</span> <span class="pl-k">list</span>(<span class="pl-v">lonMin</span><span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">3.82</span>, <span class="pl-v">lonMax</span><span class="pl-k">=</span><span class="pl-k">-</span><span class="pl-c1">3.63</span>, <span class="pl-v">latMin</span><span class="pl-k">=</span><span class="pl-c1">52.43</span>, <span class="pl-v">latMax</span><span class="pl-k">=</span><span class="pl-c1">52.52</span>)

<span class="pl-c"># Filter stations based on bounding box</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-smi">bbox</span>)

<span class="pl-c"># Filter stations belonging to a certain hydrometric area</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>haName<span class="pl-pds">"</span></span>, <span class="pl-v">entryValue</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Wye (Hereford)<span class="pl-pds">"</span></span>)

<span class="pl-c"># Filter based on bounding box &amp; metadata strings</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-smi">bbox</span>,
                          <span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>haName<span class="pl-pds">"</span></span>,
                          <span class="pl-v">entryValue</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>Wye (Hereford)<span class="pl-pds">"</span></span>)

<span class="pl-c"># Filter stations based on threshold</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-smi">bbox</span>,
                          <span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>catchmentArea<span class="pl-pds">"</span></span>,
                          <span class="pl-v">entryValue</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>&gt;1<span class="pl-pds">"</span></span>)

<span class="pl-c"># Filter based on minimum recording years</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-smi">bbox</span>,
                          <span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>catchmentArea<span class="pl-pds">"</span></span>,
                          <span class="pl-v">entryValue</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>&gt;1<span class="pl-pds">"</span></span>,
                          <span class="pl-v">minRec</span><span class="pl-k">=</span><span class="pl-c1">30</span>)

<span class="pl-c"># Filter stations based on identification number</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>,
                          <span class="pl-v">entryValue</span><span class="pl-k">=</span>c(<span class="pl-c1">3001</span>,<span class="pl-c1">3002</span>,<span class="pl-c1">3003</span>))

<span class="pl-c"># Other combined filtering</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-smi">bbox</span>,
                          <span class="pl-v">metadataColumn</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>,
                          <span class="pl-v">entryValue</span><span class="pl-k">=</span>c(<span class="pl-c1">54022</span>,<span class="pl-c1">54090</span>,<span class="pl-c1">54091</span>,<span class="pl-c1">54092</span>,<span class="pl-c1">54097</span>),
                          <span class="pl-v">minRec</span><span class="pl-k">=</span><span class="pl-c1">35</span>)</pre></div>

<h2>
<a id="conversions" class="anchor" href="#conversions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Conversions</h2>

<p>The only geospatial information contained in the list of station in the catalogue is the OS grid reference (column "gridRef"). The RNRFA package allows convenient conversion to more standard coordinate systems. The function "OSGParse()", for example, converts the string to easting and northing in the BNG coordinate system (EPSG code: 27700), as in the example below:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Where is the first catchment located?</span>
<span class="pl-smi">someStations</span><span class="pl-k">$</span><span class="pl-smi">gridReference</span>[[<span class="pl-c1">1</span>]]

<span class="pl-c"># Convert OS Grid reference to BNG</span>
OSGparse(<span class="pl-s"><span class="pl-pds">"</span>SN853872<span class="pl-pds">"</span></span>)</pre></div>

<p>The same function can also convert from BNG to latitude and longitude in the WSGS84 coordinate system (EPSG code: 4326) as in the example below.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Convert BNG to WSGS84</span>
OSGparse(<span class="pl-s"><span class="pl-pds">"</span>SN853872<span class="pl-pds">"</span></span>, <span class="pl-v">CoordSystem</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>WGS84<span class="pl-pds">"</span></span>)</pre></div>

<p>OSGparse() also works with multiple references:</p>

<div class="highlight highlight-source-r"><pre>OSGparse(<span class="pl-smi">someStations</span><span class="pl-k">$</span><span class="pl-smi">gridReference</span>)</pre></div>

<h2>
<a id="get-time-series-data" class="anchor" href="#get-time-series-data" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Get time series data</h2>

<p>The first column of the table "someStations" contains the id number. This can be used to retrieve time series data and convert waterml2 files to time series object (of class zoo). </p>

<p>The National River Flow Archive serves two types of time series data:</p>

<ul>
<li><p>Gauged Daily Flows (GDF)</p></li>
<li><p>Catchment Mean Rainfall (CMR)</p></li>
</ul>

<h3>
<a id="gauged-daily-flows" class="anchor" href="#gauged-daily-flows" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Gauged Daily Flows</h3>

<p>Gauged Daily Flows can be obtained using the function GDF(). This accepts one input, the station id (as single string or character vector). 
Here is how to retrieve daily flows for <em>Shin at Lairg (id = 3001)</em> catchment.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Fetch time series data from the waterml2 service</span>
<span class="pl-smi">data</span> <span class="pl-k">&lt;-</span> GDF(<span class="pl-s"><span class="pl-pds">"</span>3001<span class="pl-pds">"</span></span>)
<span class="pl-smi">metadata</span> <span class="pl-k">&lt;-</span> GDFmeta(<span class="pl-s"><span class="pl-pds">"</span>3001<span class="pl-pds">"</span></span>)
plot(<span class="pl-smi">data</span>, <span class="pl-v">main</span><span class="pl-k">=</span>paste(<span class="pl-s"><span class="pl-pds">"</span>Daily flow data for the<span class="pl-pds">"</span></span>, <span class="pl-smi">metadata</span><span class="pl-k">$</span><span class="pl-smi">stationName</span>, <span class="pl-s"><span class="pl-pds">"</span>catchment<span class="pl-pds">"</span></span>),
     <span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-v">ylab</span><span class="pl-k">=</span>expression(<span class="pl-smi">m</span><span class="pl-k">^</span><span class="pl-c1">3</span><span class="pl-k">/</span><span class="pl-smi">s</span>))</pre></div>

<h3>
<a id="catchment-mean-rainfall" class="anchor" href="#catchment-mean-rainfall" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Catchment Mean Rainfall</h3>

<p>Catchment Mean Rainfall can be obtained using the function CMR(). This accepts one input, the station id (as single string or character vector). 
Here is how to retrieve rainfall data for <em>Shin at Lairg (id = 3001)</em> catchment.</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Fetch time series data from the waterml2 service</span>
<span class="pl-smi">data</span> <span class="pl-k">&lt;-</span> CMR(<span class="pl-s"><span class="pl-pds">"</span>3001<span class="pl-pds">"</span></span>)
<span class="pl-smi">metadata</span> <span class="pl-k">&lt;-</span> CMRmeta(<span class="pl-s"><span class="pl-pds">"</span>3001<span class="pl-pds">"</span></span>)
plot(<span class="pl-smi">data</span>, <span class="pl-v">main</span><span class="pl-k">=</span>paste(<span class="pl-s"><span class="pl-pds">"</span>Monthly rainfall data for the<span class="pl-pds">"</span></span>,<span class="pl-smi">metadata</span><span class="pl-k">$</span><span class="pl-smi">stationName</span>,<span class="pl-s"><span class="pl-pds">"</span>catchment<span class="pl-pds">"</span></span>), 
     <span class="pl-v">xlab</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-v">ylab</span><span class="pl-k">=</span>expression(<span class="pl-smi">mm</span>))</pre></div>

<h2>
<a id="multiple-sites" class="anchor" href="#multiple-sites" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Multiple sites</h2>

<p>Retrieving information for multiple sites becomes trivial:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Search data/metadata in the waterml2 service</span>
<span class="pl-smi">s</span> <span class="pl-k">&lt;-</span> lapply(c(<span class="pl-c1">3001</span>,<span class="pl-c1">3002</span>,<span class="pl-c1">3003</span>),<span class="pl-smi">GDF</span>)

<span class="pl-c"># s is a list of 3 object (one object for each site)</span>
<span class="pl-smi">firstSite</span>  <span class="pl-k">&lt;-</span> <span class="pl-smi">s</span>[[<span class="pl-c1">1</span>]]  <span class="pl-c"># s$ID3001</span>
<span class="pl-smi">secondSite</span> <span class="pl-k">&lt;-</span> <span class="pl-smi">s</span>[[<span class="pl-c1">2</span>]]  <span class="pl-c"># s$ID3002</span>
<span class="pl-smi">thirdSite</span>  <span class="pl-k">&lt;-</span> <span class="pl-smi">s</span>[[<span class="pl-c1">3</span>]]  <span class="pl-c"># s$ID3003</span>

plot(<span class="pl-smi">secondSite</span>,<span class="pl-v">col</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>blue<span class="pl-pds">"</span></span>)
lines(<span class="pl-smi">thirdSite</span>,<span class="pl-v">col</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span>green<span class="pl-pds">"</span></span>)</pre></div>

<h2>
<a id="interoperability" class="anchor" href="#interoperability" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>INTEROPERABILITY</h2>

<h3>
<a id="upgrade-your-dataframe-to-a-datatable" class="anchor" href="#upgrade-your-dataframe-to-a-datatable" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Upgrade your data.frame to a data.table:</h3>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">DT</span>)
datatable(<span class="pl-smi">allStations</span>[,c(<span class="pl-c1">1</span><span class="pl-k">:</span><span class="pl-c1">4</span>,<span class="pl-c1">7</span>,<span class="pl-c1">9</span>,<span class="pl-c1">10</span>,<span class="pl-c1">12</span><span class="pl-k">:</span><span class="pl-c1">14</span>,<span class="pl-c1">17</span>)])</pre></div>

<h3>
<a id="create-interactive-maps-using-leaflet" class="anchor" href="#create-interactive-maps-using-leaflet" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Create interactive maps using leaflet:</h3>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">leaflet</span>)

leaflet(<span class="pl-v">data</span> <span class="pl-k">=</span> <span class="pl-smi">someStations</span>) %<span class="pl-k">&gt;</span>% addTiles() %<span class="pl-k">&gt;</span>%
  addMarkers(<span class="pl-k">~</span><span class="pl-smi">lon</span>, <span class="pl-k">~</span><span class="pl-smi">lat</span>, <span class="pl-v">popup</span> <span class="pl-k">=</span> <span class="pl-k">~</span>as.character(paste(<span class="pl-smi">id</span>,<span class="pl-smi">name</span>)))</pre></div>

<h3>
<a id="interactive-plots-using-dygraphs" class="anchor" href="#interactive-plots-using-dygraphs" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Interactive plots using dygraphs:</h3>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">dygraphs</span>)
dygraph(<span class="pl-smi">data</span>) %<span class="pl-k">&gt;</span>% dyRangeSelector()</pre></div>

<h3>
<a id="parallel-processing" class="anchor" href="#parallel-processing" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Parallel processing:</h3>

<p>A simple benchmark test</p>

<div class="highlight highlight-source-r"><pre>library(<span class="pl-smi">parallel</span>)
<span class="pl-c"># Use detectCores() to find out many cores are available on your machine</span>

<span class="pl-c"># Filter all the stations with a minimum of 100 years of recordings</span>
<span class="pl-smi">someStations</span> <span class="pl-k">&lt;-</span> catalogue(<span class="pl-v">minRec</span> <span class="pl-k">=</span> <span class="pl-c1">94</span>)</pre></div>

<p>1 core vs multiple cores </p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Get flow data with a sequential approach</span>
system.time( <span class="pl-smi">s1</span> <span class="pl-k">&lt;-</span> GDF(<span class="pl-smi">someStations</span><span class="pl-k">$</span><span class="pl-smi">id</span>) )</pre></div>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Get flow data with a parallel approach</span>
system.time( <span class="pl-smi">s2</span> <span class="pl-k">&lt;-</span> mclapply(<span class="pl-smi">someStations</span><span class="pl-k">$</span><span class="pl-smi">id</span>, <span class="pl-smi">GDF</span>, <span class="pl-v">mc.cores</span> <span class="pl-k">=</span> detectCores()) )  </pre></div>

<p>The measured flows are expected to increase with the catchment area. Let's show this simple regression on a plot:</p>

<div class="highlight highlight-source-r"><pre><span class="pl-c"># Calculate the mean flow for each catchment</span>
<span class="pl-smi">someStations</span><span class="pl-k">$</span><span class="pl-smi">meanGDF</span> <span class="pl-k">&lt;-</span> unlist( lapply(<span class="pl-smi">s2</span>, <span class="pl-smi">mean</span>) )

<span class="pl-c"># Linear model</span>
library(<span class="pl-smi">ggplot2</span>)
ggplot(<span class="pl-smi">someStations</span>, aes(<span class="pl-v">x</span> <span class="pl-k">=</span> as.numeric(<span class="pl-smi">catchmentArea</span>), <span class="pl-v">y</span> <span class="pl-k">=</span> <span class="pl-smi">meanGDF</span>)) <span class="pl-k">+</span> 
  geom_point() <span class="pl-k">+</span>
  stat_smooth(<span class="pl-v">method</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>lm<span class="pl-pds">"</span></span>, <span class="pl-v">col</span> <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>red<span class="pl-pds">"</span></span>) <span class="pl-k">+</span>
  xlab(expression(paste(<span class="pl-s"><span class="pl-pds">"</span>Catchment area [Km^2]<span class="pl-pds">"</span></span>,<span class="pl-v">sep</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>))) <span class="pl-k">+</span> 
  ylab(expression(paste(<span class="pl-s"><span class="pl-pds">"</span>Mean flow [m^3/s]<span class="pl-pds">"</span></span>,<span class="pl-v">sep</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>)))</pre></div>

<h1>
<a id="terms-and-conditions" class="anchor" href="#terms-and-conditions" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Terms and Conditions</h1>

<p>Please refer to the following Terms and Conditions for use of NRFA Data and disclaimer: <a href="http://nrfa.ceh.ac.uk/costs-terms-and-conditions">http://nrfa.ceh.ac.uk/costs-terms-and-conditions</a></p>

<p>This package uses a non-public API which is likely to change. Package and functions herein are provided as is, without any guarantee.</p>

<h1>
<a id="leave-your-feedback" class="anchor" href="#leave-your-feedback" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Leave your feedback</h1>

<p>I would greatly appreciate if you could leave your feedbacks either via email (<a href="mailto:cvitolodev@gmail.com">cvitolodev@gmail.com</a>) or taking a short survey (<a href="https://www.surveymonkey.com/s/GTGH8RX">https://www.surveymonkey.com/s/GTGH8RX</a>).</p>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/cvitolo/r_rnrfa/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/cvitolo/r_rnrfa/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/cvitolo/r_rnrfa"></a> is maintained by <a href="https://github.com/cvitolo">cvitolo</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

            <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-44379190-3");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
